(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const _ of i)if(_.type==="childList")for(const h of _.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function s(i){const _={};return i.integrity&&(_.integrity=i.integrity),i.referrerPolicy&&(_.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?_.credentials="include":i.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function a(i){if(i.ep)return;i.ep=!0;const _=s(i);fetch(i.href,_)}})();const k=`attribute vec2 position;\r
attribute vec2 uv;\r
varying highp vec2 texcoord;\r
void main(void) {\r
  gl_Position = vec4(position, 0.0, 1.0);\r
  texcoord = uv;\r
}`,Q=`varying highp vec2 texcoord;\r
uniform sampler2D texture;\r
void main() {\r
  gl_FragColor = texture2D(texture, texcoord);\r
}`,u=1,R=2,e=canvas.getContext("webgl"),M=new EventTarget,X="draw",Z=new Event(X),m=2,B=4,q=B*4,z=6,L=16,p=1/atlas.width*L,K=2/canvas.width,j=2/canvas.height;globalThis._vertices_length=0;globalThis._vertices_virtual=new Float32Array;globalThis._indexes_length=0;globalThis._indexes_virtual=new Uint16Array;function F(o,c){if(!e)throw new Error("!webgl");const s=e.createShader(o);if(!s)throw new Error("!shader");if(e.shaderSource(s,c),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS))return s;console.info(e.getShaderInfoLog(s)),e.deleteShader(s)}function J(){if(!e)throw new Error("!webgl");e.clearColor(0,0,0,1),e.viewport(0,0,canvas.width,canvas.height);const o=e.createProgram(),c=F(e.VERTEX_SHADER,k);if(!c)throw new Error("!vertex_shader");e.attachShader(o,c);const s=F(e.FRAGMENT_SHADER,Q);if(!s)throw new Error("!pixel_shader");e.attachShader(o,s),e.linkProgram(o),e.useProgram(o);const a=e.getAttribLocation(o,"position"),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i);const _=m*2*4;e.enableVertexAttribArray(a),e.vertexAttribPointer(a,m,e.FLOAT,!1,_,0);const h=e.getAttribLocation(o,"uv");e.enableVertexAttribArray(h),e.vertexAttribPointer(h,m,e.FLOAT,!1,_,m*4);const v=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,v);const d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,atlas),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)}function $(o,c,s,a,i,_,h){const v=p*i,d=p*_,f=v+p,E=d+p;ee(o,c,s,a,h&u?f:v,h&R?E:d,h&u?v:f,h&R?d:E)}function ee(o,c,s,a,i,_,h,v){const d=_vertices_length/B;_vertices_virtual[_vertices_length++]=o,_vertices_virtual[_vertices_length++]=c,_vertices_virtual[_vertices_length++]=i,_vertices_virtual[_vertices_length++]=_,_vertices_virtual[_vertices_length++]=s,_vertices_virtual[_vertices_length++]=c,_vertices_virtual[_vertices_length++]=h,_vertices_virtual[_vertices_length++]=_,_vertices_virtual[_vertices_length++]=s,_vertices_virtual[_vertices_length++]=a,_vertices_virtual[_vertices_length++]=h,_vertices_virtual[_vertices_length++]=v,_vertices_virtual[_vertices_length++]=o,_vertices_virtual[_vertices_length++]=a,_vertices_virtual[_vertices_length++]=i,_vertices_virtual[_vertices_length++]=v,_indexes_virtual[_indexes_length++]=d,_indexes_virtual[_indexes_length++]=d+1,_indexes_virtual[_indexes_length++]=d+2,_indexes_virtual[_indexes_length++]=d,_indexes_virtual[_indexes_length++]=d+2,_indexes_virtual[_indexes_length++]=d+3}function te(){if(!e)throw new Error("!webgl");_indexes_length=0,_vertices_length=0,M.dispatchEvent(Z),e.bufferData(e.ARRAY_BUFFER,_vertices_virtual,e.STATIC_DRAW),e.bufferData(e.ELEMENT_ARRAY_BUFFER,_indexes_virtual,e.STATIC_DRAW),e.clear(e.COLOR_BUFFER_BIT),e.drawElements(e.TRIANGLES,_indexes_length,e.UNSIGNED_SHORT,0)}function T(){requestAnimationFrame(te)}const w=0,n=1,g=2,D=3,C=2,y=70,U=y*K,P=y*j,O=canvas.width/y,Y=canvas.height/y;let l=null;function re(o){if(!l)throw new Error("!tilemap");switch(o.key){case"ArrowUp":l.offset_y-=1,T();break;case"ArrowDown":l.offset_y+=1,T();break;case"ArrowLeft":l.offset_x-=1,T();break;case"ArrowRight":l.offset_x+=1,T();break}}function ie(o){const c=Math.ceil(O)+1,s=Math.ceil(Y)+1,a=D*c*s;_vertices_virtual=new Float32Array(_vertices_virtual.length+a*q),_indexes_virtual=new Uint16Array(_indexes_virtual.length+a*z),l=o,window.addEventListener("keydown",re),M.addEventListener(X,ne)}function t(o,c){return o+c*L+1}function V(o,c,s){if(!l)throw new Error("!tilemap");const a=l.width*l.height;return(o*a+s*l.width+c)*C}function r(o,c,s,a,i=0){if(!l)throw new Error("!tilemap");const _=V(o,c,s);l.tiles[_]=a,l.tiles[_+1]=i}function ne(){if(!l)throw new Error("!tilemap");const o=Math.ceil(O)+1,c=Math.ceil(Y)+1,s=Math.floor(l.offset_x),a=Math.floor(l.offset_y),i=s+o,_=a+c,h=-1-(l.offset_x-s)*U,v=1+(l.offset_y-a)*P;let d=0,f=0,E=0,I=0;for(let b=0;b<D;b++){d=h;for(let x=s;x<i;x++){E=d+U,f=v;for(let A=a;A<_;A++){if(I=f-P,x>=0&&x<l.width&&A>=0&&A<l.height){const N=V(b,x,A),S=l.tiles[N];if(S){const G=l.tiles[N+1],H=(S-1)%(atlas.width/L),W=Math.ceil(S/(atlas.height/L))-1;$(d,f,E,I,H,W,G)}}f=I}d=E}}}function _e(){const a=new Uint8Array(D*99*C);ie({width:11,height:9,tiles:a,offset_x:0,offset_y:0});for(let i=0;i<11;i++){r(w,i,0,t(12,1)),r(w,i,1,t(13,1));for(let _=2;_<9;_++)r(w,i,_,t(_==2||i==0?14:15,1))}r(n,10,0,t(12,2)),r(n,10,1,t(13,2)),r(n,0,1,t(2,2),u),r(n,1,1,t(2,2)),r(n,0,2,t(3,2),u),r(n,1,2,t(3,2)),r(g,0,0,t(0,2)),r(g,0,1,t(1,2)),r(n,2,1,t(4,2)),r(n,2,2,t(5,2)),r(n,3,0,t(6,2)),r(n,4,0,t(7,2)),r(n,3,1,t(8,2)),r(n,4,1,t(9,2)),r(n,3,2,t(10,2)),r(n,4,2,t(11,2)),r(n,9,2,t(14,2)),r(n,9,3,t(15,2)),r(n,7,1,t(0,3)),r(n,7,2,t(1,3)),r(n,8,2,t(2,3)),r(n,7,3,t(3,3)),r(n,8,3,t(4,3)),r(w,7,3,t(14,1)),r(w,8,3,t(14,1)),r(n,0,4,t(5,3)),r(n,1,4,t(6,3)),r(n,2,4,t(7,3)),r(n,0,5,t(8,3)),r(n,1,5,t(9,3)),r(n,2,5,t(10,3)),r(n,0,6,t(11,3)),r(n,1,6,t(12,3)),r(n,2,6,t(13,3)),r(n,3,4,t(14,3));for(let i=4;i<=6;i++)r(n,i,4,t(15,3));r(n,7,4,t(14,3),u);for(let i=5;i<=6;i++){r(n,3,i,t(0,4));for(let _=4;_<=6;_++)r(n,_,i,t(1,4));r(n,7,i,t(0,4),u)}r(n,3,4,t(14,3));for(let i=4;i<=6;i++)r(n,i,4,t(15,3));r(n,3,7,t(14,3),R);for(let i=4;i<=6;i++)r(n,i,7,t(15,3),R);r(n,7,7,t(14,3),u|R),r(g,5,3,t(2,4)),r(g,5,4,t(3,4)),r(g,5,5,t(4,4)),r(g,5,6,t(5,4)),T()}function se(){J(),_e()}se();
